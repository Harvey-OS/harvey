load('//sys/src/FLAGS', "LIB_COMPILER_FLAGS", "CMD_LINK_OPTS")
load('//sys/src/harvey.BUILD', "harvey_binary")

CMD_SRCS = [
	"9pvpxy.c",
	"aan.c",
	"ar.c",
	"archfs.c",
	"ascii.c",
	"awd.c",
	"basename.c",
	"bind.c",
	"bsplit.c",
	"cal.c",
	"calendar.c",
	"calls.c",
	"cat.c",
	"chgrp.c",
	"chmod.c",
	"cleanname.c",
	"clock.c",
	"cmp.c",
	"col.c",
	"colors.c",
	"comm.c",
	"cp.c",
	"cpu.c",
	"crop.c",
	"date.c",
	"dc.c",
	"dd.c",
	"deroff.c",
	"du.c",
	"echo.c",
	"ecp.c",
	"factor.c",
	"fcp.c",
	"field.c",
	"file.c",
	"fmt.c",
	"fortune.c",
	"freq.c",
	"getmap.c",
	"gview.c",
	"hget.c",
	"histogram.c",
	"history.c",
	"html2ms.c",
	"iconv.c",
	"idiff.c",
	"import.c",
	"init.c",
	"join.c",
	"kbmap.c",
	"kiss.c",
	"ktrace.c",
	"lens.c",
	"lnfs.c",
	"lock.c",
	"look.c",
	"mc.c",
	"mclock.c",
	"md5sum.c",
	"mkdir.c",
	"mntgen.c",
	"ms2html.c",
	"ms.c",
	"mtime.c",
	"mug.c",
	"mv.c",
	"netstat.c",
	"news.c",
	"nm.c",
	"nntpfs.c",
	"ns.c",
	"pbd.c",
	"p.c",
	"pipefile.c",
	"pr.c",
	"primes.c",
	"pump.c",
	"pwd.c",
	"ramfs.c",
	"read.c",
	"resample.c",
	"rm.c",
	"rx.c",
	"screenlock.c",
	"seconds.c",
	"sed.c",
	"seq.c",
	"sha1sum.c",
	"size.c",
	"sleep.c",
	"sort.c",
	"split.c",
	"srvfs.c",
	"stats.c",
	"strace.c",
	"strings.c",
	"strip.c",
	"sum.c",
	"swap.c",
	"tail.c",
	"tar.c",
	"tee.c",
	"testalarm.c",
	"test.c",
	"time.c",
	"tlsclient.c",
	"tlssrv.c",
	"touch.c",
	"trace.c",
	"tr.c",
	"tweak.c",
	"unicode.c",
	"uniq.c",
	"unlnfs.c",
	"unmount.c",
	"wc.c",
	"webcookies.c",
	"webfsget.c",
	"winwatch.c",
	"xd.c",
	"yacc.c",
]

[harvey_binary(
	name=c[:-2],
	srcs=[c],
	deps=[
		"//sys/src/lib9p:lib9p",
		"//sys/src/libauth:libauth",
		"//sys/src/libauthsrv:libauthsrv",
		"//sys/src/libcomplete:libcomplete",
		"//sys/src/libcontrol:libcontrol",
		"//sys/src/libdisk:libdisk",
		"//sys/src/libdraw:libdraw",
		"//sys/src/libflate:libflate",
		"//sys/src/libframe:libframe",
		"//sys/src/libgeometry:libgeometry",
		"//sys/src/libhttpd:libhttpd",
		"//sys/src/libip:libip",
		"//sys/src/liblex:liblex",
		"//sys/src/libmach:libmach",
		"//sys/src/libmemlayer:libmemlayer",
		"//sys/src/libmemdraw:libmemdraw",
		"//sys/src/libmp:libmp",
		"//sys/src/libndb:libndb",
		"//sys/src/libplumb:libplumb",
		"//sys/src/libregexp:libregexp",
		"//sys/src/libsec:libsec",
		"//sys/src/libstdio:libstdio",
		"//sys/src/libString:libString",
		"//sys/src/libthread:libthread",
		"//sys/src/libusb:libusb",
		"//sys/src/libventi:libventi",
		"//sys/src/liboventi:liboventi",
		"//sys/src/libbio:libbio",
		"//sys/src/libc:libc",
	],
		linkopts=CMD_LINK_OPTS
) for c in CMD_SRCS]

harvey_binary(
	name="mount",
	srcs=[
		"mount.c"
	],
	deps=[
		"//sys/src/libauth:libauth",
		"//sys/src/libc:libc",
	],
)

harvey_binary(
	name="srv",
	srcs=[
		"srv.c"
	],
	deps=[
		"//sys/src/libauth:libauth",
		"//sys/src/libc:libc",
	]
)

harvey_binary(
	name="ls",
	srcs=[
		"ls.c"
	],
	deps=[
		"//sys/src/libbio:libbio",
		"//sys/src/libc:libc",
	],
)

harvey_binary(
	name="ps",
	srcs=[
		"ps.c"
	],
	deps=[
		"//sys/src/libbio:libbio",
		"//sys/src/libc:libc",
	],
)

harvey_binary(
	name="ed",
	srcs=[
		"ed.c"
	],
	deps=[
		"//sys/src/libregexp:libregexp",
		"//sys/src/libbio:libbio",
		"//sys/src/libc:libc",
	],
	includes=[
		"//sys/include",
		"//amd64/include",
		"//sys/src/libregexp",
	],
 )

harvey_binary(
	name="ratrace",
	srcs=[
		"ratrace.c"
	],
	deps=[
        "//sys/src/libthread:libthread",
        "//sys/src/libc:libc",
	]
)
