#!/bin/rc

# Regression tests for devufs

fn pass {
	echo PASS
	exit PASS	
}

fn fail {
	echo FAIL - $1
	exit FAIL	
}


img=testufsimg

if (test -f $img)
{
	fail $img^' already exists'
}

if (test -d /dev/ufs/0)
{
	fail '/dev/ufs/0 already exists'
}


# Create and mount
newfs $img
if (! ~ $status '') {
	fail 'Could not create img'
}
echo $img > /dev/ufs/mount


# Tests
cat /dev/ufs/0/stats


# Tidy up
echo unmount > /dev/ufs/0/ctl
rm $img

pass
